import{c as S,m as F,o as c,a as h,b as n,t as p,w as d,v as k,F as u,r as g,n as f,d as C,e as b,f as w,g as _,T as y,h as v,i as O}from"./vendor.js";const T=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}};T();const A=[255,255,255],E=[[A]];class L{constructor(t,r,o=[0,0,0]){const a=t instanceof HTMLCanvasElement?t:document.querySelector(t);this.canvas=a,this.ctx=a.getContext("2d"),this.fragment=r||E,this.params={width:a.offsetWidth,height:a.offsetHeight,bg:o},a.width=this.params.width,a.height=this.params.height,this.clear()}get bg(){return this.params.bg}set bg(t){this.params.bg=t,this.clear()}get width(){return this.params.width}set width(t){this.params.width=t,this.canvas.width=t,this.clear()}get height(){return this.params.height}set height(t){this.params.height=t,this.canvas.height=t,this.clear()}getBlob(t="image/png"){return new Promise(r=>{this.canvas.toBlob(r,t)})}rgba(t,r,o,a){return Array.isArray(t)&&([t,r,o,a]=t),`rgba(${t||0}, ${r||0}, ${o||0}, ${a||1})`}clear(){this.stop(),this.ctx.clearRect(0,0,this.params.width,this.params.height),this.ctx.fillStyle=this.rgba(this.params.bg),this.ctx.fillRect(0,0,this.params.width,this.params.height)}stop(){this._drawTO&&clearTimeout(this._drawTO),this._iterateTO&&clearTimeout(this._iterateTO)}draw(t){const r=this._computeIterations();this.fragment=this._normalizeFragment(this.fragment,r.length);let o=r.length;this.clear();const a=(s=0)=>{this._drawTO=setTimeout(()=>{this.iteration(0,r[s],()=>{o--,r[s+1]&&a(s+1),o<=0&&t(this.canvas)})},100)};a()}iteration(t=0,r,o){this._iterateTO=setTimeout(()=>{let a=0;for(;a<=r.countY;)this.figure(t,a,r.ratio),a++;if(t++,t<=r.countX)return this.iteration(t,r,o);o()},0)}figure(t,r,o){const a=this.fragment.length*o;this.fragment.forEach((s,i)=>{const l=s.length*o;s.forEach((m,z)=>{this.ctx.fillStyle=this.rgba(m),this.ctx.fillRect(t*l+z*o,r*a+i*o,o,o)})})}_computeIterations(){const t=[];let r=1;const o=this.fragment[0].length,a=this.fragment.length,s=()=>{const i=Math.floor(this.width/(r*o)),l=Math.floor(this.height/(r*a));if(i>0&&l>0)t.push({ratio:r,countX:i,countY:l}),r=r*2,s();else return t};return s(),t}_normalizeFragment(t,r=1){const o=(1/r).toFixed(2);return t.map(a=>a.map(s=>{let i;return Array.isArray(s)?i=[...s.slice(0,3)]:s?i=[255,255,255]:i=[0,0,0],[...i,o]}))}}var U=(e,t)=>{const r=e.__vccOpts||e;for(const[o,a]of t)r[o]=a;return r};const j={data:()=>({size:{w:4,h:4},background:"n",color:"w",figureSize:"screen",points:[],drawing:!1,drawed:!1,fractal:null}),computed:{colors:()=>({n:[0,0,0],w:[255,255,255],r:[255,50,50],g:[50,255,50],b:[50,50,255],y:[255,255,50]}),figureSizes:()=>[{value:"screen",label:"Screen size"},{value:"fixed",label:"2500x2500"}],colorsKeys(){return Object.keys(this.colors)},params(){return{bg:this.colors[this.background],color:this.colors[this.color],fragment:S(F(this.points,e=>this.colors[e]),this.size.w)}}},watch:{"size.w":{handler(e,t){this.size.h==t&&(this.size.h=e),this.updateFragment()},immediate:!0},"size.h":{handler(){this.updateFragment()},immediate:!0},color:{immediate:!0,handler(){this.color==="n"&&this.background==="n"&&(this.background="w"),this.color==="w"&&this.background==="w"&&(this.background="n")}},background:{immediate:!0,handler(e,t){this.background==="n"&&this.color==="n"&&(this.color="w"),this.background==="w"&&this.color==="w"&&(this.color="n"),this.points=this.points.map(r=>r==t?e:r)}},figureSize:{handler(){requestAnimationFrame(()=>{const e=this.$refs.draw.offsetWidth,t=this.$refs.draw.offsetHeight;this.fractal.width=e,this.fractal.height=t})}},"params.fragment":{handler(){this.fractal.fragment=this.params.fragment}},"params.bg":{handler(){this.fractal.bg=this.params.bg}}},mounted(){this.fractal=new L(this.$refs.draw,this.params.fragment,this.params.bg)},methods:{updateFragment(){const e=this.size.w*this.size.h;if(this.points.length>e)this.points=this.points.slice(0,e);else if(this.points.length<e){const t=[];for(let r=0;r<e-this.points.length;r++)t.push(this.background);this.points=this.points.concat(t)}},onChangePoint(e,t){this.points[e]=t.target.checked?this.color:this.background},draw(){this.drawing||(this.drawed=!1,this.drawing=!0,this.fractal.draw(()=>{this.drawing=!1,this.drawed=!0}))},clear(){if(this.drawing)return;const e=this.size.w*this.size.h,t=[];for(let r=0;r<e;r++)t.push(this.background);this.points=t,this.fractal.clear()},stop(){!this.drawing||(this.drawed=!1,this.drawing=!1,this.fractal.stop())},async download(){if(!this.drawed)return;const e="image/png",t="fractal.png",r=await this.fractal.getBlob(e),o=new File([r],t,{type:e}),a=URL.createObjectURL(o),s=document.createElement("A");if(s.setAttribute("href",a),s.setAttribute("download",t),document.createEvent){const i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),s.dispatchEvent(i)}else s.click();URL.revokeObjectURL(a)}}},P={class:"layout"},R={class:"layout__controls"},V={class:"layout__label"},B=n("div",{class:"layout__label"}," Pixel color ",-1),M={class:"colors"},I=["value"],N={key:0,class:"color__check"},D=n("div",{class:"layout__label"}," Background color ",-1),H={class:"colors"},K=["value"],q={key:0,class:"color__check"},W=n("div",{class:"layout__label"}," Figure ",-1),X=["checked","onInput"],Y=n("div",{class:"layout__label"}," Fractal size ",-1),$={class:"controls"},G=["value"],J={class:"bool__label"},Q={key:0,class:"bool__check"},Z=n("div",{class:"layout__label"}," Control ",-1),x={class:"controls"},tt=["disabled"],et=["disabled"],st=["disabled"],it=["disabled"],at={class:"layout__content"};function rt(e,t,r,o,a,s){return c(),h("div",P,[n("aside",R,[n("label",V,"Size: "+p(e.size.w)+"x"+p(e.size.h),1),d(n("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.size.w=i),class:"range",type:"range",min:"1",max:"15"},null,512),[[k,e.size.w]]),d(n("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.size.h=i),class:"range",type:"range",min:"1",max:"15"},null,512),[[k,e.size.h]]),B,n("div",M,[(c(!0),h(u,null,g(s.colorsKeys,i=>(c(),h("label",{key:i,class:"color",style:f({"background-color":`rgba(${s.colors[i].join(",")})`})},[d(n("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>e.color=l),value:i,type:"radio",name:"color",class:"color__input"},null,8,I),[[b,e.color]]),w(y,{"enter-from-class":"m_hidden","leave-to-class":"m_hidden"},{default:_(()=>[i===e.color?(c(),h("div",N)):v("",!0)]),_:2},1024)],4))),128))]),D,n("div",H,[(c(!0),h(u,null,g(s.colorsKeys,i=>(c(),h("label",{key:i,class:"color",style:f({"background-color":`rgba(${s.colors[i].join(",")})`})},[d(n("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>e.background=l),value:i,type:"radio",name:"color",class:"color__input"},null,8,K),[[b,e.background]]),w(y,{"enter-from-class":"m_hidden","leave-to-class":"m_hidden"},{default:_(()=>[i===e.background?(c(),h("div",q)):v("",!0)]),_:2},1024)],4))),128))]),W,n("div",{class:"grid",style:f({"grid-template-columns":`repeat(${e.size.w}, 1fr)`,"grid-template-rows":`repeat(${e.size.h}, 1fr)`})},[(c(!0),h(u,null,g(e.points,(i,l)=>(c(),h("label",{key:l,class:"pixel",style:f({"background-color":`rgba(${s.colors[i].join(",")})`})},[n("input",{type:"checkbox",checked:i===e.color,class:"pixel__input",onInput:m=>s.onChangePoint(l,m)},null,40,X)],4))),128))],4),Y,n("div",$,[(c(!0),h(u,null,g(s.figureSizes,i=>(c(),h("label",{key:i.value,class:"bool"},[d(n("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>e.figureSize=l),value:i.value,type:"radio",name:"figure_size",class:"bool__input"},null,8,G),[[b,e.figureSize]]),n("span",J,p(i.label),1),w(y,{"enter-from-class":"m_hidden","leave-to-class":"m_hidden"},{default:_(()=>[i.value===e.figureSize?(c(),h("div",Q)):v("",!0)]),_:2},1024)]))),128))]),Z,n("div",x,[n("button",{type:"button",class:"button",disabled:e.drawing,onClick:t[5]||(t[5]=(...i)=>s.draw&&s.draw(...i))}," Draw ",8,tt),n("button",{type:"button",class:"button",disabled:e.drawing,onClick:t[6]||(t[6]=(...i)=>s.clear&&s.clear(...i))}," Clear ",8,et),n("button",{type:"button",class:"button",disabled:!e.drawing,onClick:t[7]||(t[7]=(...i)=>s.stop&&s.stop(...i))}," Stop ",8,st),n("button",{type:"button",class:"button",disabled:!(!e.drawing&&e.drawed),onClick:t[8]||(t[8]=(...i)=>s.download&&s.download(...i))}," Download ",8,it)])]),n("article",at,[n("canvas",{ref:"draw",class:C(["draw",`m_${e.figureSize}`])},null,2)])])}var ot=U(j,[["render",rt]]);const nt=O(ot);nt.mount("body");
